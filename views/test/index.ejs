<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>voice Call</title>
    </head>
    <body>
        <div>
            Total Connected User: <span id="total-user-count">1</span>
            <button style="float: right;" onclick="endCall();">End Call</button>
            <button style="float: right;" id="mute-unmute-call" onclick="muteUnmuteCall();">Mute</button>
        </div>
        <div id="main-streaming"></div>

        <script src="http://localhost:4000/streaming/v1/voice-stream.js"></script>
        <script>
            const roomID = "my-aud-call";
            const userID = Math.floor(Math.random() * 10000) + "";
            const userName = "userName" + userID;
            const pwcKit = PwcUIKitPrebuilt.create(roomID, userID, userName);
            console.log("pwcKit", pwcKit);
            pwcKit.joinRoom({
                container: document.querySelector("#main-streaming"),
            });

            setInterval(function() { 
                let totalUserCount = pwcKit.userCount();
                document.getElementById('total-user-count').innerHTML=parseInt(totalUserCount)+1;
            }, 1000);

            function endCall() {
                pwcKit.endCall();
                window.location.href = '/';
            }

            var callStat = 1;
            function muteUnmuteCall() {
                if (callStat) {
                    pwcKit.mute();
                    callStat=0;
                    document.getElementById('mute-unmute-call').innerHTML="Unmute";
                } else {
                    pwcKit.unmute();
                    callStat = 1;
                    document.getElementById('mute-unmute-call').innerHTML="Mute";
                }
            }
        </script>
    </body>
</html>

